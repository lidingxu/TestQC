include("startup.jl")
include("Entanglement.jl")

using MultiStates
using LinearAlgebra


# the state as MultiState object

rho = zeros(ComplexF64, 12, 12)

    rho[1,1] = 0.0719399704541392275 + 0*im
    rho[1,2] = 0.0175746605220128641 + 0.000233296796704322963*im
    rho[1,3] = -0.00664179810858686096 - 0.01057664290720807778*im
    rho[1,4] = 0.0028045586922825553 + 0.00124762838484829540*im
    rho[1,5] = 0.0016856379749778647 - 0.00040505114480783224*im
    rho[1,6] = -0.00394191338209179314 - 0.00247478961286535965*im
    rho[1,7] = -0.0279488561965744740 - 0.0224071925270748920*im
    rho[1,8] = -0.0199495323013772544 + 0.00647548011396433477*im
    rho[1,9] = -0.00348999527887290160 + 0.00130407511050512320*im
    rho[1,10] = -0.00792160744094328970 - 0.0088005583204671123*im
    rho[1,11] = 0.000601777063370447871 - 0.00067851950431806925*im
    rho[1,12] = -0.001530583940828947267 + 0.000179070781254618226*im

    rho[2,1] = 0.0175746605220128641 - 0.000233296796704322963*im
    rho[2,2] = 0.10847459183756677123
    rho[2,3] = 0.0190382572339156838 - 0.000142015739496605001*im
    rho[2,4] = -0.0015347198567656723 - 0.00055650245535423324*im
    rho[2,5] = 0.0092982474411407437 - 0.00509468607348380663*im
    rho[2,6] = 0.0214564670497825934 + 0.00772853465007868809*im
    rho[2,7] = 0.0200627439273069622 - 0.00812456659840586686*im
    rho[2,8] = -0.0057360519484554808 - 0.0183721881213093777*im
    rho[2,9] = -0.0005503503843494718 + 9.97471820937262*10^-6*im
    rho[2,10] = -0.003126555662134631349 + 0.00086498031746384575*im
    rho[2,11] = -0.00511499227852452279 - 0.00802704247435654438*im
    rho[2,12] = 0.000378744339874897892 - 0.00098596700363862820*im

    rho[3,1] = -0.00664179810858686096 + 0.01057664290720807778*im 
    rho[3,2] = 0.0190382572339156838 + 0.000142015739496605001*im 
    rho[3,3] = 0.0716784553026240760 + 0.0*10^-22*im 
    rho[3,4] = -0.00337171431546524570 - 0.00209025867206596891*im 
    rho[3,5] = -0.0184181193100612789 - 0.00578088850233465529*im 
    rho[3,6] = -0.0103111988834750222 + 0.00178429505151496212*im 
    rho[3,7] = -0.00418491557384696376 + 0.00235242457900803718*im 
    rho[3,8] = 0.0011069617275073846 - 0.00120988573760309394*im 
    rho[3,9] = -0.0074476440753623492 - 0.0277147682846506499*im 
    rho[3,10] = -0.001435707842690535405 - 0.000570513225891906475*im 
    rho[3,11] = -0.000279556275362750292 - 0.00245918469686624385*im 
    rho[3,12] = -0.00259433471367056234 - 0.0103241946841034758*im

    rho[4,1] = 0.0028045586922825553 - 0.00124762838484829540*im 
    rho[4,2] = -0.0015347198567656723 + 0.00055650245535423324*im 
    rho[4,3] = -0.00337171431546524570 + 0.00209025867206596891*im 
    rho[4,4] = 0.0861625426771739067 + 0.0*10^-22*im 
    rho[4,5] = 0.0037121202620056516 - 0.000536806291761774378*im 
    rho[4,6] = -0.00620103265928821288 + 0.00082513931046535905*im 
    rho[4,7] = 0.00621908414324405775 + 0.0128906914089249998*im 
    rho[4,8] = -0.000160731679608131605 + 0.00209990801260225975*im 
    rho[4,9] = -0.000950645936976271403 + 0.000278973427638773639*im 
    rho[4,10] = -0.0173594549145366385 + 0.0211683117189940845*im 
    rho[4,11] = -0.0216699789747105666 + 0.00400835667655142069*im 
    rho[4,12] = -0.00433696865828070976 + 0.00185825205459836284*1

    rho[5,1] = 0.0016856379749778647 + 0.00040505114480783224*im 
    rho[5,2] = 0.0092982474411407437 + 0.00509468607348380663*im 
    rho[5,3] = -0.0184181193100612789 + 0.00578088850233465529*im 
    rho[5,4] = 0.0037121202620056516 + 0.000536806291761774378*im 
    rho[5,5] = 0.11963429705132211782
    rho[5,6] = 0.0047665664651023205 - 0.000803268195977822372*im 
    rho[5,7] = 0.000432711064886181012 + 0.00096230896149109740*im 
    rho[5,8] = 0.00537679996382677634 + 0.01134059871890374187*im 
    rho[5,9] = -0.000014116542648905600 + 0.00156676206002325574*im 
    rho[5,10] = 0.0207561484402488743 - 0.00382959212963901288*im 
    rho[5,11] = 0.0038114741706777046 + 0.0260530770101982673*im 
    rho[5,12] = -0.0007566625523584128 - 0.00253178915256460201*im

    rho[6,1] = -0.00394191338209179314 + 0.00247478961286535965*im 
    rho[6,2] = 0.0214564670497825934 - 0.00772853465007868809*im 
    rho[6,3] = -0.0103111988834750222 - 0.00178429505151496212*im 
    rho[6,4] = -0.00620103265928821288 - 0.00082513931046535905*im 
    rho[6,5] = -0.0047665664651023205 + 0.000803268195977822372*im 
    rho[6,6] = 0.0808725426771739060 + 0.0*10^-22*im 
    rho[6,7] = 0.000745185777431499017 + 0.000823725593771243830*im 
    rho[6,8] = 0.000875222205526754173 + 0.00017591868143706655*im 
    rho[6,9] = 0.00361181141597133058 + 0.0104628126210462121*im 
    rho[6,10] = -0.00257013694990181023 + 0.00153812376319756287*im 
    rho[6,11] = 0.0003964152319912530 + 0.00109823148121933873*im 
    rho[6,12] = 0.0011393329642512436 + 0.0213831602038425693*im
    
    rho[7,1] = -0.0279488561965744740 + 0.0224071925270748920*im 
    rho[7,2] = 0.0200627439273069622 + 0.00812456659840586686*im 
    rho[7,3] = -0.00418491557384696376 - 0.00235242457900803718*im 
    rho[7,4] = 0.00621908414324405775 - 0.0128906914089249998*im 
    rho[7,5] = 0.000432711064886181012 - 0.00096230896149109740*im 
    rho[7,6] = 0.000745185777431499017 - 0.000823725593771243830*im 
    rho[7,7] = 0.0569197871216183504 + 0.0*10^-22*im 
    rho[7,8] = -0.0027857526754575751 + 0.001494606825283540049*im 
    rho[7,9] = -0.00546589997834820133 + 0.00115971892807267243*im 
    rho[7,10] = -0.0118264940458179060 + 0.00227860191818200775*im 
    rho[7,11] = -0.0003373759535506470 - 0.00108269525002132375*im 
    rho[7,12] = -0.00445524962168836536 - 0.00062439153990097133*im

    rho[8,1] = -0.0199495323013772544 - 0.00647548011396433477*im 
    rho[8,2] = -0.0057360519484554808 + 0.0183721881213093777*im 
    rho[8,3] = 0.0011069617275073846 + 0.00120988573760309394*im 
    rho[8,4] = -0.000160731679608131605 - 0.00209990801260225975*im 
    rho[8,5] = 0.00537679996382677634 - 0.01134059871890374187*im 
    rho[8,6] = 0.000875222205526754173 - 0.00017591868143706655*im 
    rho[8,7] = -0.0027857526754575751 - 0.001494606825283540049*im 
    rho[8,8] = 0.09280940816243322894
    rho[8,9] = 0.0036996346214456459 + 0.001392531589779351608*im 
    rho[8,10] = -0.0010028541195490900 + 0.00259237213367004249*im 
    rho[8,11] = -0.0111297585522518538 - 0.00252624725984952704*im 
    rho[8,12] = 0.0191819859469543183 + 0.00454066168480571958*im

    rho[9,1] = -0.00348999527887290160 - 0.00130407511050512320*im 
    rho[9,2] = -0.0005503503843494718 - 9.97471820937262*10^-6*im 
    rho[9,3] = -0.0074476440753623492 + 0.0277147682846506499*im 
    rho[9,4] = -0.000950645936976271403 - 0.000278973427638773639*im 
    rho[9,5] = -0.000014116542648905600 - 0.00156676206002325574*im 
    rho[9,6] = 0.00361181141597133058 - 0.0104628126210462121*im 
    rho[9,7] = -0.00546589997834820133 - 0.00115971892807267243*im 
    rho[9,8] = 0.0036996346214456459 - 0.001392531589779351608*im 
    rho[9,9] = 0.0607897871216183512 + 0.0*10^-22*im 
    rho[9,10] = -0.00452216554520982799 - 0.00003879866927183379*im 
    rho[9,11] = -0.0205013344702447109 - 0.00482768666134824418*im 
    rho[9,12] = -0.0310925546518785138 + 0.00268920797878806840*im 

    rho[10,1] = -0.00792160744094328970 + 0.0088005583204671123*im
    rho[10,2] = -0.003126555662134631349 - 0.00086498031746384575*im
    rho[10,3] = -0.001435707842690535405 + 0.000570513225891906475*im
    rho[10,4] = -0.0173594549145366385 - 0.0211683117189940845*im
    rho[10,5] = 0.0207561484402488743 + 0.00382959212963901288*im
    rho[10,6] = -0.00257013694990181023 - 0.00153812376319756287*im
    rho[10,7] = -0.0118264940458179060 - 0.00227860191818200775*im
    rho[10,8] = -0.0010028541195490900 - 0.00259237213367004249*im
    rho[10,9] = -0.00452216554520982799 + 0.00003879866927183379*im
    rho[10,10] = 0.0714818371208058926 + 0.0*10^-22*im
    rho[10,11] = -0.0223908239862777553 + 0.000233296796704322963*im
    rho[10,12] = -0.00622773619684372622 + 0.00910826250092020825*im

    rho[11,1] = 0.000601777063370447871 + 0.00067851950431806925*im 
    rho[11,2] = -0.00511499227852452279 + 0.00802704247435654438*im 
    rho[11,3] = -0.000279556275362750292 + 0.00245918469686624385*im 
    rho[11,4] = -0.0216699789747105666 - 0.00400835667655142069*im 
    rho[11,5] = 0.0038114741706777046 - 0.0260530770101982673*im 
    rho[11,6] = 0.0003964152319912530 - 0.00109823148121933873*im 
    rho[11,7] = -0.0003373759535506470 + 0.00108269525002132375*im 
    rho[11,8] = -0.0111297585522518538 + 0.00252624725984952704*im 
    rho[11,9] = -0.0205013344702447109 + 0.00482768666134824418*im 
    rho[11,10] = -0.0223908239862777553 - 0.000233296796704322963*im 
    rho[11,11] = 0.10801645850423343626
    rho[11,12] = 0.0230913555535518755 - 0.000142015739496605001*1

    rho[12,1] = -0.001530583940828947267 - 0.000179070781254618226*im 
    rho[12,2] = 0.000378744339874897892 + 0.00098596700363862820*im 
    rho[12,3] = -0.00259433471367056234 + 0.0103241946841034758*im 
    rho[12,4] = -0.00433696865828070976 - 0.00185825205459836284*im 
    rho[12,5] = -0.0007566625523584128 + 0.00253178915256460201*im 
    rho[12,6] = 0.0011393329642512436 - 0.0213831602038425693*im 
    rho[12,7] = -0.00445524962168836536 + 0.00062439153990097133*im 
    rho[12,8] = 0.0191819859469543183 - 0.00454066168480571958*im 
    rho[12,9] = -0.0310925546518785138 - 0.00268920797878806840*im 
    rho[12,10] = -0.00622773619684372622 - 0.00910826250092020825*im 
    rho[12,11] = -0.0230913555535518755 + 0.000142015739496605001*im 
    rho[12,12] = 0.0712203219692907410 + 0.0*10^-22*im

rho = MultiState(rho, [2, 2, 3])

M = rho.mat



#GENUINE MULTIPARTITE ENTANGLEMENT


t = Entanglement.EntanglementRobustness(rho, method="PPT_mixer")

println("PPT mixer visibility: ",t)


## BIPARTITE ENTANGLEMENT


# compute the maximal t s.t. t rho + (1-t) Id/d is PPT in partition A|BC

rhoA_BC = MultiState(M, [2, 6])

t = Entanglement.EntanglementRobustness(rhoA_BC, method="PPT")

println("PPT visibility in A|BC partition: ",t)


# compute the maximal t s.t. t rho + (1-t) Id/d is PPT in partition AB|C

rhoAB_C = MultiState(M, [4, 3])

t = Entanglement.EntanglementRobustness(rhoAB_C, method="PPT")

println("PPT visibility in AB|C partition: ",t)

# compute the maximal t s.t. t rho + (1-t) Id/d is PPT in partition B|AC

rhoAC_B = PermuteSystems(rho, 2, 3)

rhoAC_B = MultiState(rhoAC_B.mat, [6, 2])

t = Entanglement.EntanglementRobustness(rhoAC_B, method="PPT")

println("PPT visibility in AC|B partition: ", t)




